<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Prendre un ticket | WaQtek</title>
    <style>
        :root {
            --bg-1: #f2f7fb;
            --bg-2: #dcebf7;
            --card: #ffffff;
            --title: #12314c;
            --text: #34556f;
            --muted: #607d95;
            --accent: #0f4f7a;
            --normal: #2e7d32;
            --normal-press: #1f5a23;
            --vip: #f3c623;
            --vip-press: #d6a908;
            --surface: #eef5fc;
            --ok: #1f7a2b;
            --warn: #8b6d00;
            --border: #c3d8eb;
            --shadow: 0 20px 40px rgba(13, 53, 84, 0.16);
            --radius: 20px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            min-height: 100vh;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text);
            background: radial-gradient(circle at 12% 10%, #ffffff 0%, #ffffff00 38%), linear-gradient(150deg, var(--bg-1) 0%, var(--bg-2) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 18px;
        }

        .kiosk {
            width: min(920px, 100%);
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: clamp(20px, 3.2vw, 36px);
        }

        .topbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 14px;
            margin-bottom: clamp(22px, 3vw, 32px);
        }

        .brand {
            font-size: clamp(1.2rem, 2vw, 1.6rem);
            color: var(--title);
            font-weight: 700;
            letter-spacing: 0.3px;
        }

        .lang-wrap {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 8px 10px;
        }

        .lang-wrap label {
            font-size: 0.92rem;
            color: var(--muted);
            font-weight: 600;
        }

        .lang-wrap select {
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 6px 10px;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--title);
            background: #fff;
        }

        .lang-wrap select:focus {
            outline: 3px solid #98c5e8;
            outline-offset: 1px;
        }

        h1 {
            color: var(--title);
            font-size: clamp(2rem, 5vw, 3rem);
            margin-bottom: 10px;
            text-align: center;
        }

        .subtitle {
            text-align: center;
            color: var(--muted);
            font-size: clamp(1rem, 2.1vw, 1.35rem);
            margin-bottom: clamp(20px, 4vw, 34px);
            font-weight: 500;
        }

        .queues-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
            gap: 16px;
        }

        .kiosk-context {
            margin-bottom: 16px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 10px 12px;
            text-align: center;
        }

        .kiosk-context-title {
            font-size: 0.86rem;
            color: var(--muted);
            margin-bottom: 4px;
            font-weight: 600;
        }

        .kiosk-context-value {
            color: var(--title);
            font-weight: 700;
            font-size: 0.98rem;
        }

        .queue-card {
            border: none;
            border-radius: 16px;
            min-height: clamp(100px, 14vh, 130px);
            background: #f8fbff;
            border: 1px solid var(--border);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: center;
            gap: 8px;
            padding: 14px;
            color: var(--title);
            transition: transform 0.12s ease, filter 0.12s ease, box-shadow 0.12s ease;
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.08);
            touch-action: manipulation;
            user-select: none;
        }

        .queue-card:active,
        .queue-card.is-pressed {
            transform: scale(0.98);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .queue-card:focus-visible {
            outline: 4px solid #8ec2e8;
            outline-offset: 2px;
        }

        .queue-card-title {
            font-size: 1.1rem;
            font-weight: 700;
        }

        .queue-card-desc {
            color: var(--muted);
            font-size: 0.92rem;
        }

        .empty-queues {
            border: 1px dashed var(--border);
            border-radius: 14px;
            padding: 14px;
            text-align: center;
            color: var(--muted);
        }

        .ticket-modal {
            position: fixed;
            inset: 0;
            display: none;
            align-items: center;
            justify-content: center;
            background: rgba(11, 37, 56, 0.46);
            z-index: 9999;
            padding: 16px;
        }

        .ticket-modal.show {
            display: flex;
        }

        .ticket-modal-card {
            width: min(460px, 100%);
            background: #fff;
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 18px;
        }

        .ticket-modal-title {
            color: var(--title);
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .ticket-modal-subtitle {
            color: var(--muted);
            margin-bottom: 14px;
        }

        .ticket-options {
            display: grid;
            gap: 10px;
        }

        .ticket-option {
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 12px;
            text-align: left;
            font-size: 0.98rem;
            font-weight: 700;
            cursor: pointer;
            color: var(--title);
            background: #fff;
        }

        .ticket-option.local {
            background: linear-gradient(165deg, #e4f7e6 0%, #d2efd6 100%);
            border-color: #99d3a0;
        }

        .ticket-option.remote {
            background: linear-gradient(165deg, #fff7d8 0%, #fcefc2 100%);
            border-color: #ead28b;
        }

        .ticket-modal-cancel {
            margin-top: 10px;
            border: 0;
            border-radius: 10px;
            padding: 10px 12px;
            width: 100%;
            background: #e4ebf3;
            color: #27435a;
            font-weight: 700;
            cursor: pointer;
        }

        .feedback {
            margin-top: 20px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 14px 16px;
            min-height: 84px;
            display: grid;
            align-content: center;
            gap: 5px;
        }

        .feedback-title {
            font-weight: 700;
            color: var(--accent);
            font-size: 1.06rem;
        }

        .feedback-msg {
            font-size: 0.96rem;
            color: var(--muted);
        }

        .feedback.ok .feedback-title { color: var(--ok); }
        .feedback.warn .feedback-title { color: var(--warn); }

        .footer-note {
            text-align: center;
            margin-top: 12px;
            font-size: 0.86rem;
            color: #6a859b;
        }

        html[dir="rtl"] .topbar {
            flex-direction: row-reverse;
        }

        html[dir="rtl"] .ticket-btn {
            flex-direction: row-reverse;
        }

        @media (max-width: 820px) {
            .topbar {
                align-items: stretch;
                flex-direction: column;
            }

            .lang-wrap {
                justify-content: center;
            }
        }

        @media (max-height: 700px) {
            body {
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <main class="kiosk" aria-live="polite">
        <div class="topbar">
            <p class="brand">WaQtek Kiosk</p>
            <div class="lang-wrap">
                <label for="langSelect" id="langLabel">Langue</label>
                <select id="langSelect" aria-labelledby="langLabel">
                    <option value="fr">FR</option>
                    <option value="ar">AR</option>
                </select>
            </div>
        </div>

        <h1 id="title">Prendre un ticket</h1>
        <p class="subtitle" id="subtitle">Appuyez pour obtenir votre ticket</p>
        <section class="kiosk-context">
            <p id="contextTitle" class="kiosk-context-title">Kiosk actif</p>
            <p id="contextValue" class="kiosk-context-value">Chargement de la configuration...</p>
        </section>

        <section id="queuesGrid" class="queues-grid" aria-label="Queues">
        </section>
        <section id="emptyQueues" class="empty-queues" style="display:none;">
            Aucune queue disponible.
        </section>

        <section id="feedback" class="feedback" role="status">
            <p id="feedbackTitle" class="feedback-title">En attente</p>
            <p id="feedbackMessage" class="feedback-msg">Selectionnez un type de ticket pour continuer.</p>
        </section>

        <p id="footerNote" class="footer-note">Ecran adapte aux tablettes et bornes tactiles.</p>
    </main>

    <div id="ticketChoiceModal" class="ticket-modal" aria-hidden="true">
        <div class="ticket-modal-card">
            <h2 id="modalQueueTitle" class="ticket-modal-title">Choisir le type de ticket</h2>
            <p id="modalSubtitle" class="ticket-modal-subtitle">Selectionnez une option</p>
            <div class="ticket-options">
                <button id="localTicketBtn" class="ticket-option local" type="button">Ticket Local (gratuit)</button>
                <button id="remoteTicketBtn" class="ticket-option remote" type="button">Ticket avec acces distant (50 DA)</button>
            </div>
            <button id="cancelModalBtn" class="ticket-modal-cancel" type="button">Annuler</button>
        </div>
    </div>

    <script src="../js/config.js"></script>
    <script src="../js/core/StateManager.js"></script>
    <script src="../js/core/ApiClient.js"></script>
    <script src="../js/core/WebSocketClient.js"></script>
    <script src="../js/init.js"></script>
    <script src="../js/services/AuthService.js"></script>
    <script src="../js/services/EstablishmentService.js"></script>
    <script src="../js/services/QueueService.js"></script>
    <script src="../js/services/TicketService.js"></script>
    <script src="../js/services/StatsService.js"></script>
    <script src="../js/services/RealtimeService.js"></script>
    <script src="../js/utils.js"></script>
    <script src="../js/pages/client/take-ticket.js"></script>
    <script src="../js/pages.js"></script>
    <script src="../js/components/dynamic-menu.js"></script>
</body>
</html>
