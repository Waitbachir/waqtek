<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>WaQtek | Établissements</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="../css/style.css">

<style>
:root {
    --primary: #2563eb;
    --primary-dark: #1d4ed8;
    --danger: #dc2626;
    --bg: #f1f5f9;
    --sidebar: #0f172a;
    --sidebar-hover: #1e293b;
    --text-light: #cbd5e1;
    --white: #ffffff;
    --border: #e5e7eb;
    --shadow: 0 10px 30px rgba(0,0,0,.08);
}

/* ===== BASE ===== */
body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background: var(--bg);
}

.layout {
    display: flex;
    height: 100vh;
}

/* ===== SIDEBAR ===== */
.sidebar {
    width: 250px;
    background: var(--sidebar);
    color: var(--white);
    padding: 25px;
    display: flex;
    flex-direction: column;
}

.sidebar h2 {
    text-align: center;
    margin-bottom: 35px;
}

.sidebar a {
    display: block;
    padding: 12px 15px;
    border-radius: 8px;
    text-decoration: none;
    color: var(--text-light);
    margin-bottom: 8px;
    transition: 0.2s;
}

.sidebar a:hover {
    background: var(--sidebar-hover);
    color: var(--white);
}

/* ===== CONTENT ===== */
.content {
    flex: 1;
    padding: 35px;
    overflow-y: auto;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 35px;
}

.header h1 {
    margin: 0;
}

/* ===== BUTTONS ===== */
.btn {
    padding: 10px 18px;
    border-radius: 8px;
    border: none;
    font-weight: 600;
    cursor: pointer;
    transition: 0.2s;
}

.btn-primary {
    background: var(--primary);
    color: white;
}

.btn-primary:hover {
    background: var(--primary-dark);
}

.btn-danger {
    background: var(--danger);
    color: white;
}

.btn-danger:hover {
    opacity: 0.9;
}

/* ===== CARD ===== */
.card {
    background: var(--white);
    padding: 25px;
    border-radius: 12px;
    box-shadow: var(--shadow);
    margin-bottom: 30px;
}

.card h3 {
    margin-top: 0;
}

/* ===== FORM ===== */
.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 15px;
}

.form-grid input,
.form-grid textarea {
    padding: 10px;
    border: 1px solid var(--border);
    border-radius: 6px;
    font-size: 14px;
}

.form-grid textarea {
    grid-column: 1 / -1;
    min-height: 80px;
    resize: vertical;
}

/* ===== TABLE ===== */
.table-container {
    background: var(--white);
    border-radius: 12px;
    box-shadow: var(--shadow);
    overflow: hidden;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th, td {
    padding: 15px;
    text-align: left;
}

th {
    background: #f8fafc;
    font-weight: 600;
}

tr:not(:last-child) {
    border-bottom: 1px solid var(--border);
}

.actions button {
    margin-right: 8px;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 900px) {
    .layout {
        flex-direction: column;
        height: auto;
        min-height: 100vh;
    }

    .sidebar {
        width: 100%;
    }

    .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
    }
}
</style>
    <link rel="stylesheet" href="../css/responsive.css">
</head>
<body>

<script>
if (!localStorage.getItem("waqtek_token")) {
    window.location.href = "sign-in.html";
}
</script>

<div class="layout">
<!-- CONTENT -->
<main class="content">

    <div class="header">
        <h1>Gestion des Établissements</h1>
        <button class="btn btn-danger logout" onclick="logout()">Déconnexion</button>
    </div>

    <!-- CREATE CARD -->
    <div class="card">
        <h3>Créer un établissement</h3>

        <div class="form-grid">
            <input type="text" id="estName" placeholder="Nom">
            <input type="text" id="estAddress" placeholder="Adresse">
            <input type="email" id="estEmail" placeholder="Email (optionnel)">
            <input type="tel" id="estPhone" placeholder="Téléphone (optionnel)">
            <textarea id="estDescription" placeholder="Description (optionnel)"></textarea>
        </div>

        <br>
        <button class="btn btn-primary" id="createEstBtn">
            ➕ Créer l’établissement
        </button>
    </div>

    <!-- TABLE CARD -->
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Nom</th>
                    <th>Adresse</th>
                    <th>Email</th>
                    <th>Créé le</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="estTable">
                <tr>
                    <td colspan="5">Chargement...</td>
                </tr>
            </tbody>
        </table>
    </div>

</main>
</div>

<!-- Core Scripts -->
<script src="../js/config.js"></script>
<script src="../js/core/StateManager.js"></script>
<script src="../js/core/ApiClient.js"></script>
<script src="../js/core/WebSocketClient.js"></script>
<script src="../js/init.js"></script>

<!-- Services -->
<script src="../js/services/AuthService.js"></script>
<script src="../js/services/EstablishmentService.js"></script>
<script src="../js/services/QueueService.js"></script>
<script src="../js/services/TicketService.js"></script>
<script src="../js/services/StatsService.js"></script>
<script src="../js/services/RealtimeService.js"></script>

<!-- Utilities -->
<script src="../js/utils.js"></script>

<!-- Page Script -->
<script src="../js/pages/enterprise/establishments.js"></script>

<script>
async function logout() {
    try {
        if (window.AuthService && typeof AuthService.logout === 'function') {
            await AuthService.logout();
        } else {
            localStorage.removeItem("waqtek_token");
            localStorage.removeItem("waqtek_user");
        }
    } finally {
        window.location.href = "sign-in.html";
    }
}
</script>


<script src="../js/pages.js"></script>
<script src="../js/components/dynamic-menu.js"></script>
</body>
</html>

